@namespace
class SpriteKind:
    gun = SpriteKind.create()
    CameraTrigger = SpriteKind.create()
    HUD = SpriteKind.create()
    OffscreenProjectile = SpriteKind.create()
    DestroyedPlayer = SpriteKind.create()

def on_up_pressed():
    handleDirectionInput(0, 1, 0, -10)
controller.up.on_event(ControllerButtonEvent.PRESSED, on_up_pressed)

def on_b_pressed():
    global offscreenHorizontally, offscreenVertically
    if canShoot:
        updateInputMode((inputMode + 1) % 2)
        offscreenHorizontally = vehicleSprite.right < scene.camera_left() or vehicleSprite.left > scene.camera_left() + scene.screen_width()
        offscreenVertically = vehicleSprite.bottom < scene.camera_top() or vehicleSprite.top > scene.camera_top() + scene.screen_height()
        if offscreenHorizontally or offscreenVertically:
            scene.center_camera_at(vehicleSprite.x, vehicleSprite.y - 8)
controller.B.on_event(ControllerButtonEvent.PRESSED, on_b_pressed)

def on_up_repeated():
    handleDirectionInput(0, 2, 0, -5)
controller.up.on_event(ControllerButtonEvent.REPEATED, on_up_repeated)

def cameraFollowSprite(toFollow: Sprite):
    global cameraSprite
    scene.camera_follow_sprite(bullet)
    cameraSprite = bullet

def on_a_pressed():
    global canShoot, bullet
    if canShoot:
        canShoot = False
        updateInputMode(1)
        bullet = sprites.create(img("""
                . . . . . 
                            . . 4 . . 
                            . 4 8 4 . 
                            . . 4 . . 
                            . . . . .
            """),
            SpriteKind.projectile)
        positionSpriteRelativeTo(gunSprite,
            sprites.read_data_number(vehicleSprite, "gunEndX") - gunSpriteHalfWidth,
            sprites.read_data_number(vehicleSprite, "gunEndY") - gunSpriteHalfWidth,
            bullet)
        if len(sprites.all_of_kind(SpriteKind.projectile)) == 1:
            cameraFollowSprite(bullet)
        bullet.ay = 100
        bullet.ax = windSpeed
        bullet.set_flag(SpriteFlag.DESTROY_ON_WALL, True)
        bullet.vx = sprites.read_data_number(vehicleSprite, "gunUnitX") * sprites.read_data_number(vehicleSprite, "bulletPower")
        bullet.vy = sprites.read_data_number(vehicleSprite, "gunUnitY") * (0 - sprites.read_data_number(vehicleSprite, "bulletPower"))
controller.A.on_event(ControllerButtonEvent.PRESSED, on_a_pressed)

def on_on_overlap(sprite, otherSprite):
    global vehicleToDeleteIndex, activePlayer, viewTrigger
    sprite.destroy()
    vehicleToDeleteIndex = vehicleSprites.index(otherSprite)
    if vehicleToDeleteIndex <= activePlayer:
        activePlayer += -1
    gunSprites.remove_at(vehicleToDeleteIndex).destroy()
    vehicleSprites.remove_at(vehicleToDeleteIndex).destroy(effects.fire, 500)
    viewTrigger = sprites.create(image.create(0, 0), SpriteKind.CameraTrigger)
    viewTrigger.lifespan = 3000
sprites.on_overlap(SpriteKind.projectile, SpriteKind.player, on_on_overlap)

def on_right_repeated():
    handleDirectionInput(-3, 0, 5, 0)
controller.right.on_event(ControllerButtonEvent.REPEATED, on_right_repeated)

def on_left_pressed():
    handleDirectionInput(1, 0, -10, 0)
controller.left.on_event(ControllerButtonEvent.PRESSED, on_left_pressed)

def updateHUDValue(hudSprite: Sprite, value: str):
    hudSprite.image.fill_rect(0, 0, hudSprite.width, hudSprite.height, 0)
    localExtensions.draw_text5_in(value, hudSprite.image, 0, 0, 1)
def drawTurrent():
    sprites.set_data_number(vehicleSprite,
        "gunAngle",
        (sprites.read_data_number(vehicleSprite, "gunAngle") + 360) % 360)
    sprites.set_data_number(vehicleSprite,
        "bulletPower",
        Math.constrain(sprites.read_data_number(vehicleSprite, "bulletPower"),
            0,
            350))
    gunSprite.set_image(image.create(gunSprite.width, gunSprite.height))
    sprites.set_data_number(vehicleSprite,
        "gunAngleRad",
        sprites.read_data_number(vehicleSprite, "gunAngle") * (3.14159 / 180))
    sprites.set_data_number(vehicleSprite,
        "gunUnitX",
        Math.cos(sprites.read_data_number(vehicleSprite, "gunAngleRad")))
    sprites.set_data_number(vehicleSprite,
        "gunUnitY",
        Math.sin(sprites.read_data_number(vehicleSprite, "gunAngleRad")))
    sprites.set_data_number(vehicleSprite,
        "gunEndX",
        Math.round(sprites.read_data_number(vehicleSprite, "gunUnitX") * gunLength + gunSpriteHalfWidth))
    sprites.set_data_number(vehicleSprite,
        "gunEndY",
        Math.round(gunSpriteHalfWidth - sprites.read_data_number(vehicleSprite, "gunUnitY") * gunLength))
    gunSprite.image.draw_line(gunSpriteHalfWidth,
        gunSpriteHalfWidth,
        sprites.read_data_number(vehicleSprite, "gunEndX"),
        sprites.read_data_number(vehicleSprite, "gunEndY"),
        8)
    updateHUDValue(powerLabel,
        convert_to_text(sprites.read_data_number(vehicleSprite, "bulletPower")))
    updateHUDValue(angleLabel,
        convert_to_text(sprites.read_data_number(vehicleSprite, "gunAngle")))
def initAllHUDSprites():
    global panIndicator, windLegend, windIndicator, windLabel, legend, angleLabel, powerLabel
    panIndicator = sprites.create(img("""
            ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ...............................................................................666..............................................................................
                    ..............................................................................66166.............................................................................
                    .............................................................................6611166............................................................................
                    ............................................................................661111166...........................................................................
                    ...........................................................................66111611166..........................................................................
                    ..........................................................................6611166611166.........................................................................
                    .........................................................................6611166.6611166........................................................................
                    ........................................................................6611166...6611166.......................................................................
                    ........................................................................611166.....661116.......................................................................
                    ........................................................................61166.......66116.......................................................................
                    ........................................................................6166.........6616.......................................................................
                    ........................................................................666...........666.......................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ............66666...............................................................................................................................66666...........
                    ...........661116...............................................................................................................................611166..........
                    ..........6611166...............................................................................................................................6611166.........
                    .........6611166.................................................................................................................................6611166........
                    ........6611166...................................................................................................................................6611166.......
                    .......6611166.....................................................................................................................................6611166......
                    ......6611166.......................................................................................................................................6611166.....
                    .....6611166.........................................................................................................................................6611166....
                    .....611166...........................................................................................................................................661116....
                    .....6611166.........................................................................................................................................6611166....
                    ......6611166.......................................................................................................................................6611166.....
                    .......6611166.....................................................................................................................................6611166......
                    ........6611166...................................................................................................................................6611166.......
                    .........6611166.................................................................................................................................6611166........
                    ..........6611166...............................................................................................................................6611166.........
                    ...........661116...............................................................................................................................611166..........
                    ............66666...............................................................................................................................66666...........
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ........................................................................666...........666.......................................................................
                    ........................................................................6166.........6616.......................................................................
                    ........................................................................61166.......66116.......................................................................
                    ........................................................................611166.....661116.......................................................................
                    ........................................................................6611166...6611166.......................................................................
                    .........................................................................6611166.6611166........................................................................
                    ..........................................................................6611166611166.........................................................................
                    ...........................................................................66111611166..........................................................................
                    ............................................................................661111166...........................................................................
                    .............................................................................6611166............................................................................
                    ..............................................................................66166.............................................................................
                    ...............................................................................666..............................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
                    ................................................................................................................................................................
        """),
        SpriteKind.HUD)
    windLegend = sprites.create(img("""
            . . . . . . . . . . . . . . . . . . . . 
                    1 . . . 1 . . 1 . . 1 . . 1 . . 1 1 1 . 
                    1 . . . 1 . . 1 . . 1 1 . 1 . . 1 . . 1 
                    1 . 1 . 1 . . 1 . . 1 1 1 1 . . 1 . . 1 
                    1 . 1 . 1 . . 1 . . 1 . 1 1 . . 1 . . 1 
                    1 1 1 1 . . . 1 . . 1 . . 1 . . 1 1 1 . 
                    . . . . . . . . . . . . . . . . . . . .
        """),
        SpriteKind.HUD)
    windLegend.image.replace(1, hudTextColor)
    windIndicator = sprites.create(img("""
            . . . . . . . 1 1 . . . 
                    . . . . . . . 1 1 1 . . 
                    1 1 1 1 1 1 1 1 1 1 1 . 
                    1 1 1 1 1 1 1 1 1 1 1 1 
                    1 1 1 1 1 1 1 1 1 1 1 . 
                    . . . . . . . 1 1 1 . . 
                    . . . . . . . 1 1 . . .
        """),
        SpriteKind.HUD)
    windIndicator.image.replace(1, hudTextColor)
    windLabel = sprites.create(image.create(12, 5), SpriteKind.HUD)
    updateHUDValue(windLabel, convert_to_text(abs(windSpeed)))
    legend = sprites.create(img("""
            . . . 1 1 . . . 
                    . . . . 1 1 1 . 
                    1 1 1 1 1 1 1 1 
                    . . . . 1 1 1 . 
                    . . . 1 1 . . . 
                    . . . . . . . . 
                    . 1 . . . . . . 
                    . 1 . . . . . . 
                    . 1 1 1 . . . . 
                    . 1 . . 1 . . . 
                    . 1 . . . 1 . . 
                    . 1 1 1 1 1 1 .
        """),
        SpriteKind.HUD)
    legend.image.replace(1, hudTextColor)
    angleLabel = sprites.create(image.create(26, 5), SpriteKind.HUD)
    powerLabel = sprites.create(image.create(26, 5), SpriteKind.HUD)
    initHUDSprite(windLegend, scene.screen_width() - 54, 3)
    initHUDSprite(windIndicator, scene.screen_width() - 30, 3)
    initHUDSprite(windLabel, scene.screen_width() - 14, 4)
    initHUDSprite(panIndicator, 0, 0)
    initHUDSprite(legend, 2, scene.screen_height() - 14)
    initHUDSprite(angleLabel, 12, scene.screen_height() - 7)
    initHUDSprite(powerLabel, 12, scene.screen_height() - 14)
    if windSpeed == 0:
        windLegend.set_flag(SpriteFlag.INVISIBLE, True)
        windIndicator.set_flag(SpriteFlag.INVISIBLE, True)
        windLabel.set_flag(SpriteFlag.INVISIBLE, True)
    elif windSpeed < 0:
        windIndicator.image.flip_x()

def on_on_destroyed(sprite):
    global canShoot
    if len(sprites.all_of_kind(SpriteKind.CameraTrigger)) == 0 and len(sprites.all_of_kind(SpriteKind.projectile)) == 0:
        canShoot = True
        updateActivePlayer((activePlayer + 1) % len(vehicleSprites))
        scene.center_camera_at(vehicleSprite.x, vehicleSprite.y - 8)
        if len(sprites.all_of_kind(SpriteKind.player)) == 1:
            game.over(True)
sprites.on_destroyed(SpriteKind.CameraTrigger, on_on_destroyed)

def initHUDSprite(hudSprite: Sprite, left: number, top: number):
    hudSprite.set_flag(SpriteFlag.RELATIVE_TO_CAMERA, True)
    hudSprite.left = left
    hudSprite.top = top
    hudSprite.z = 100

def on_right_pressed():
    handleDirectionInput(-1, 0, 10, 0)
controller.right.on_event(ControllerButtonEvent.PRESSED, on_right_pressed)

def updateInputMode(mode: number):
    global inputMode
    inputMode = mode
    panIndicator.set_flag(SpriteFlag.INVISIBLE, inputMode != 0)
    legend.set_flag(SpriteFlag.INVISIBLE, inputMode == 0)
    powerLabel.set_flag(SpriteFlag.INVISIBLE, inputMode == 0)
    angleLabel.set_flag(SpriteFlag.INVISIBLE, inputMode == 0)

def on_down_repeated():
    handleDirectionInput(0, -2, 0, 5)
controller.down.on_event(ControllerButtonEvent.REPEATED, on_down_repeated)

def on_down_pressed():
    handleDirectionInput(0, -1, 0, 10)
controller.down.on_event(ControllerButtonEvent.PRESSED, on_down_pressed)

def initTilemap():
    global hudTextColor
    hudTextColor = 1
    if Math.percent_chance(75):
        scene.set_background_color(9)
        tiles.set_tilemap(tilemap("""
            level4
        """))
    elif Math.percent_chance(75):
        scene.set_background_color(9)
        tiles.set_tilemap(tilemap("""
            level5
        """))
    else:
        scene.set_background_color(11)
        tiles.set_tilemap(tilemap("""
            level6
        """))
def updateActivePlayer(nextActive: number):
    global activePlayer, vehicleSprite, gunSprite, activePlayerNotification
    activePlayer = nextActive
    vehicleSprite = vehicleSprites[activePlayer]
    gunSprite = gunSprites[activePlayer]
    updateHUDValue(powerLabel,
        convert_to_text(sprites.read_data_number(vehicleSprite, "bulletPower")))
    updateHUDValue(angleLabel,
        convert_to_text(sprites.read_data_number(vehicleSprite, "gunAngle")))
    activePlayerNotification = sprites.create(image.create(100, 9), SpriteKind.HUD)
    activePlayerNotification.image.fill_rect(0,
        0,
        activePlayerNotification.width,
        activePlayerNotification.height,
        5)
    localExtensions.draw_text5_in("" + sprites.read_data_string(vehicleSprite, "playerName") + " turn...",
        activePlayerNotification.image,
        2,
        2,
        8)
    initHUDSprite(activePlayerNotification, 30, 32)
    activePlayerNotification.lifespan = 1800
def handleDirectionInput(rotationChange: number, powerChange: number, cameraOffsetXChange: number, cameraOffsetYChange: number):
    if inputMode == 0:
        scene.center_camera_at(scene.camera_left() + (scene.screen_width() / 2 + cameraOffsetXChange),
            scene.camera_top() + (scene.screen_height() / 2 + cameraOffsetYChange))
    else:
        sprites.change_data_number_by(vehicleSprite, "gunAngle", rotationChange)
        sprites.change_data_number_by(vehicleSprite, "bulletPower", powerChange)
        drawTurrent()

def on_on_destroyed2(sprite):
    global bullet, viewTrigger
    if sprite.top <= 0:
        bullet = sprites.create(sprite.image, SpriteKind.OffscreenProjectile)
        bullet.set_position(sprite.x, sprite.y)
        bullet.ay = sprite.ay
        bullet.set_velocity(sprite.vx, sprite.vy)
        bullet.set_flag(SpriteFlag.GHOST, True)
        bullet.set_flag(SpriteFlag.DESTROY_ON_WALL, True)
        if sprite == cameraSprite:
            cameraFollowSprite(bullet)
    else:
        if not (sprite.is_hitting_tile(CollisionDirection.LEFT) or sprite.is_hitting_tile(CollisionDirection.LEFT)):
            scene.camera_shake(2, 400)
        viewTrigger = sprites.create(image.create(0, 0), SpriteKind.CameraTrigger)
        viewTrigger.lifespan = 600
sprites.on_destroyed(SpriteKind.projectile, on_on_destroyed2)

def positionSpriteRelativeTo(source: Sprite, offsetX: number, offsetY: number, spriteToPosition: Sprite):
    spriteToPosition.set_position(source.x + offsetX, source.y + offsetY)

def on_left_repeated():
    handleDirectionInput(3, 0, -5, 0)
controller.left.on_event(ControllerButtonEvent.REPEATED, on_left_repeated)

"""

1.0: initial release

2.0:

- bugfix: fix bug moving to next player after a vehicle is destroyed (only affects 3+ player count games)

- add wind

- add two new (low probability) alternate levels

- prompt for player count

"""
legend: Sprite = None
windLabel: Sprite = None
windIndicator: Sprite = None
hudTextColor = 0
windLegend: Sprite = None
panIndicator: Sprite = None
angleLabel: Sprite = None
powerLabel: Sprite = None
viewTrigger: Sprite = None
vehicleToDeleteIndex = 0
cameraSprite: Sprite = None
bullet: Sprite = None
offscreenVertically = False
offscreenHorizontally = False
inputMode = 0
gunSprite: Sprite = None
windSpeed = 0
gunSpriteHalfWidth = 0
gunLength = 0
gunSprites: List[Sprite] = []
vehicleSprites: List[Sprite] = []
activePlayer = 0
canShoot = False
activePlayerNotification: Sprite = None
vehicleSprite: Sprite = None
playerCount = 2
if blockSettings.exists("vehicles.playerCount"):
    playerCount = blockSettings.read_number("vehicles.playerCount")
playerCount = localExtensions.ask_for_number("players", 2, 5, playerCount)
blockSettings.write_number("vehicles.playerCount", playerCount)
canShoot = True
activePlayer = 0
vehicleSprites = sprites.all_of_kind(SpriteKind.player)
gunSprites = sprites.all_of_kind(SpriteKind.gun)
gunLength = 7
gunSpriteHalfWidth = 10
maxWindSpeed = 20
vehicleDesigns = [img("""
        . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . e e e e e e . . . . . 
            . . . e e f f f f f f e e . . . 
            . . e f f 7 7 e 7 7 7 f f e . . 
            . e f f 7 e 7 7 7 e 7 7 f f e . 
            . e f e 7 7 7 e 7 7 7 e 7 f e . 
            e f 7 7 7 e 7 7 7 e 7 7 e 7 f e 
            f b d f c c 7 c c 7 c c d f b f 
            e b f f 9 9 9 9 9 9 9 9 f f b e 
            . e e c e e c e e c e e c e e .
    """),
    img("""
        . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . e . . . . . . . 
            . . . . . . . . 2 e e . . . . . 
            . . . . . . . . 4 4 e . . . . . 
            . . . . . . . . 4 4 . . . . . . 
            . . . . . . . 4 . . . . . . . . 
            . . . . . 2 e 2 e . . . . . . . 
            . . . . . e 5 e . . . . . . . . 
            . . . . . . . . e . . . . . . . 
            . . . . . . . . . . . . . . . .
    """),
    img("""
        . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . e e e e e e . . . . . 
            . . . e e f f f f f f e e . . . 
            . . e f f 3 3 e 3 3 3 f f e . . 
            . e f f 3 e 3 3 3 e 3 3 f f e . 
            . e f e 3 3 3 e 3 3 3 e 3 f e . 
            e f 3 3 3 e 3 3 3 e 3 3 e 3 f e 
            f b d f c c 3 c c 3 c c d f b f 
            e b f f 3 3 3 3 3 3 3 3 f f b e 
            . e e c e e c e e c e e c e e .
    """),
    img("""
        . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . e e e e e e . . . . . 
            . . . e e f f f f f f e e . . . 
            . . e f f 4 4 e 4 4 4 f f e . . 
            . e f f 4 e 4 4 4 e 4 4 f f e . 
            . e f e 4 4 4 e 4 4 4 e 4 f e . 
            e f 4 4 4 e 4 4 4 e 4 4 e 4 f e 
            f b d f c c 4 c c 4 c c d f b f 
            e b f f 4 4 4 4 4 4 4 4 f f b e 
            . e e c e e c e e c e e c e e .
    """),
    img("""
        . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . e e e e e e . . . . . 
            . . . e e f f f f f f e e . . . 
            . . e f f 8 8 e 8 8 8 f f e . . 
            . e f f 8 e 8 8 8 e 8 8 f f e . 
            . e f e 8 8 8 e 8 8 8 8 8 f e . 
            e f 8 8 8 e 8 8 8 e 8 8 e 8 f e 
            f b d f c c 8 c c 8 c c d f b f 
            e b f f 8 8 8 8 8 8 8 8 f f b e 
            . e e c e e c e e c e e c e e .
    """)]
initTilemap()
windSpeed = randint(0 - maxWindSpeed, maxWindSpeed)
initAllHUDSprites()
updateInputMode(0)
index = 0
while index <= playerCount - 1:
    gunSprite = sprites.create(image.create(21, 21), SpriteKind.gun)
    vehicleSprite = sprites.create(vehicleDesigns[index % len(vehicleDesigns)],
        SpriteKind.player)
    vehicleSprites.append(vehicleSprite)
    gunSprites.append(gunSprite)
    sprites.set_data_number(vehicleSprite, "gunAngle", randint(30, 150))
    sprites.set_data_number(vehicleSprite, "bulletPower", 100)
    sprites.set_data_string(vehicleSprite, "playerName", "Player " + str((index + 1)))
    tiles.place_on_random_tile(vehicleSprite, assets.tile("""
        tile3
    """))
    positionSpriteRelativeTo(vehicleSprite, 0, 0, gunSprite)
    tiles.set_tile_at(tiles.get_tile_location(int(vehicleSprite.x / 16), int(vehicleSprite.y / 16)),
        assets.tile("""
            tile0
        """))
    drawTurrent()
    index += 1
for value in tiles.get_tiles_by_type(assets.tile("""
    tile3
""")):
    tiles.set_tile_at(value, assets.tile("""
        tile0
    """))
updateActivePlayer(activePlayer)
scene.center_camera_at(vehicleSprite.x, vehicleSprite.y - 8)

def on_on_update():
    for value2 in sprites.all_of_kind(SpriteKind.OffscreenProjectile):
        if value2.top >= 0:
            value2.set_flag(SpriteFlag.GHOST, False)
            value2.set_kind(SpriteKind.projectile)
game.on_update(on_on_update)
